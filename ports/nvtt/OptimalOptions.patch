diff --git a/cmake/OptimalOptions.cmake b/cmake/OptimalOptions.cmake
index ac450c9..6d130f9 100644
--- a/cmake/OptimalOptions.cmake
+++ b/cmake/OptimalOptions.cmake
@@ -53,9 +53,15 @@ IF(MSVC)
 #	SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} /arch:SSE2 /fp:fast")
 #	SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /arch:SSE2 /fp:fast")
 
+	#don't change the CRT_LINKAGE
+	SET(CRT_LINKAGE_FLAG "/MT")
+	if(CMAKE_CXX_FLAGS_RELEASE MATCHES "/MD")
+		SET(CRT_LINKAGE_FLAG "/MD")
+	ENDIF()
+	
 	# Optimization flags.
-	SET(CMAKE_C_FLAGS_RELEASE "${CMAKE_C_FLAGS} /O2 /Ob2 /Oi /Ot /Oy /GL")
-	SET(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS} /O2 /Ob2 /Oi /Ot /Oy /GL")
+	SET(CMAKE_C_FLAGS_RELEASE "${CMAKE_C_FLAGS} ${CRT_LINKAGE_FLAG} /O2 /Ob2 /Oi /Ot /Oy /GL")
+	SET(CMAKE_CXX_FLAGS_RELEASE "${CMAKE_CXX_FLAGS} ${CRT_LINKAGE_FLAG} /O2 /Ob2 /Oi /Ot /Oy /GL")
 	SET(CMAKE_EXE_LINKER_FLAGS_RELEASE "${CMAKE_EXE_LINKER_FLAGS_RELEASE} /LTCG")
 	SET(CMAKE_SHARED_LINKER_FLAGS_RELEASE "${CMAKE_SHARED_LINKER_FLAGS_RELEASE} /LTCG")
 	SET(CMAKE_MODULE_LINKER_FLAGS_RELEASE "${CMAKE_MODULE_LINKER_FLAGS_RELEASE} /LTCG")
